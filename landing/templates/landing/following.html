{% load static %}
{% load crispy_forms_tags %}

{% if user.is_authenticated %}

<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Profile</title>
    <link rel="stylesheet" href="{% static 'css/landing.css' %}">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link href='https://cdn.boxicons.com/fonts/basic/boxicons.min.css' rel='stylesheet'>
    <script type="text/javascript" src="{% static 'js/login.js' %}"></script>
    <title></title>
</head>
<body>
    <nav class="navbar">
        <header>
            <img class="img" src="{% static 'website_photos/Guetto Logo.png'%}" />
        </header>
        <a class="home" href="{% url 'landing' %}"><span class="text-home"><i class='bx  bx-home'></i><span>Accueil</span></span></a>
        <a class="option" href="{% url 'foryoupage' %}"><span class="text-home"><i class='bxr  bx-contact-book'></i> <span>Pour Toi</span></span></a>
        <button class="option" onclick="SearchToggle('search')"><span class="text-home"><i class='bxr  bx-search'></i> <span>Rechercher</span></span></button>
        <a href="{% url 'profile' user.profile.pk %}" class="option"><span class="text-home"><i class='bxr  bx-user-circle'></i><span>Profil</span></span></a>
        <a href="{% url 'settings' %}" class="settings"><span class="text-home"><i class='bxr  bx-user-circle'></i><span>Settings</span></span></a>
        <form method="post" action="{% url 'logout' %}" class="logout">
            {% csrf_token %}
            <a type="submit" href="{% url 'logout' %}" class="logout-text"><span class="text-home"><i class='bx  bx-home'></i><span>Se d√©connecter</span></span></a>
        </form>
    </nav>
    <div class="content">
        <div class="search-bar d-none" id="search">
            <form method="GET" class="search-button" action="{% url 'search' %}">
                <input type="search" name="query" placeholder="Rechercher un utilisateur..." />
                <button type="submit"><i class='bx bx-search'></i></button>
            </form>
            {% if profile_list %}
            {% for profile in profile_list %}
            <p class="result"><a href="{% url 'profile' profile.pk %}" style="color:dodgerblue; font-family:Calibri; font-size:16px;"><strong>@{{ profile.user }}</strong></a></p>

            {% endfor %}
            {% endif %}
        </div>
        <div>
            <h1 class="welcome-text">Following Posts</h1>
        </div>
        {% for post in post_list %}
        <div class="post-1">
            <div style="display: flex;align-items: center; flex-direction: row;gap:1vw;">
                <img class="userimage-home" src="{{ post.author.profile.user_picture.url }}" width="10" height="10">
                <p style="text-decoration: none;"><a href="{% url 'profile' post.author.pk %}" style="color:dodgerblue;"><strong>@{{ post.author }}</strong></a> {{ post.created_on }}</p>
            </div>
            {% if post.image %}
            <img src="{{ post.image.url }}" class="post-image" alt="Post Image">
            {% endif %}
            {% if post.video %}
            <video controls autoplay class="post-video">
                <source src="{{ post.video.url }}" type="video/mp4">
            </video>
            {% endif %}
            <p>{{ post.body }}</p>
            <form method="POST" action="{% url 'like' post.pk %}">
                {% csrf_token %}
                <button type="submit"><i class='bxr  bx-like'></i><span> {{ post.likes.all.count }}</span></button>
            </form>
        </div>
        {% endfor %}
    </div>
</body>
</html>

{% endif %}